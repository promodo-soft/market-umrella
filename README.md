# Моніторинг органічного трафіку сайтів через Ahrefs API

Цей скрипт дозволяє моніторити органічний трафік сайтів через Ahrefs API, зберігати дані в Excel-таблицю та отримувати повідомлення в Telegram про падіння трафіку.

## Функціональність

- Збір даних про органічний трафік сайтів через Ahrefs API
- Збереження даних в Excel-таблицю
- Автоматичне виконання за розкладом (за замовчуванням - щонеділі о 3:00)
- Відправка повідомлень в Telegram про падіння трафіку більш ніж на 5%
- Можливість налаштування розкладу через конфігураційний файл

## Вимоги

- Python 3.7+
- Встановлені пакети з файлу `requirements.txt`
- API ключ Ahrefs
- Токен Telegram бота

## Встановлення

1. Клонуйте репозиторій або завантажте файли проекту
2. Встановіть необхідні залежності:

```bash
pip install -r requirements.txt
```

3. Налаштуйте файл `.env` з вашими параметрами:

```
AHREFS_API_KEY=ваш_ключ_api_ahrefs
TELEGRAM_BOT_TOKEN=ваш_токен_telegram_бота
SCHEDULE_DAY=sunday
SCHEDULE_TIME=03:00
```

4. Додайте домени для моніторингу в файл `domains.txt` (по одному домену на рядок)

## Створення Telegram бота

1. Відкрийте Telegram і знайдіть бота @BotFather
2. Відправте команду `/newbot`
3. Дотримуйтесь інструкцій для створення нового бота
4. Після створення бота ви отримаєте токен, який потрібно додати в файл `.env`
5. Додайте бота в чат, де ви хочете отримувати повідомлення
6. Відправте команду `/start` боту в чаті

## Запуск

Для запуску скрипта виконайте:

```bash
python main.py
```

Скрипт запустить Telegram бота і планувальник, який буде виконувати збір даних за розкладом.

## Команди Telegram бота

- `/start` - Запустити бота і зареєструвати чат для отримання повідомлень
- `/help` - Показати довідку
- `/status` - Перевірити статус бота

## Налаштування розкладу

Розклад можна змінити в файлі `.env`:

- `SCHEDULE_DAY` - день тижня (monday, tuesday, wednesday, thursday, friday, saturday, sunday)
- `SCHEDULE_TIME` - час у форматі HH:MM (24-годинний формат)

## Структура проекту

- `main.py` - основний файл скрипта
- `ahrefs_api.py` - модуль для роботи з API Ahrefs
- `telegram_bot.py` - модуль для роботи з Telegram ботом
- `data_manager.py` - модуль для роботи з даними
- `config.py` - конфігураційний файл
- `.env` - файл з секретними параметрами
- `domains.txt` - список доменів для моніторингу
- `traffic_data.xlsx` - файл з даними про трафік (створюється автоматично)
- `requirements.txt` - список залежностей

## Логування

Скрипт створює наступні файли логів:
- `main.log` - основний лог
- `ahrefs_api.log` - лог роботи з API Ahrefs
- `telegram_bot.log` - лог роботи Telegram бота
- `data_manager.log` - лог роботи з даними 